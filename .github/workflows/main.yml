name: Build and Release

 

on:

  push:

    tags:

      - 'v*' 

 

jobs:

  release:

    runs-on: windows-latest

 

    steps:

      - name: Checkout code

        uses: actions/checkout@v4

 

      - name: Setup Node.js

        uses: actions/setup-node@v4

        with:

          node-version: '20'

          cache: 'npm'

 

      - name: Install dependencies

        run: npm install --ignore-scripts

 

      - name: Build Windows application

        run: npx electron-builder --win

        env:

          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}

 

      - name: Upload Windows artifacts

        uses: actions/upload-artifact@v4

        with:

          name: windows-installer

          path: |

            dist/*.exe

            dist/latest.yml

 

      - name: Create Release and Upload Assets

        uses: softprops/action-gh-release@v1

        with:

          files: |

            dist/*.exe

            dist/latest.yml

          draft: false

          prerelease: false

          generate_release_notes: true

        env:

          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
